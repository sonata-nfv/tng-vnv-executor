{
  "callbacks": [
    {
      "name": "running",
      "path": "/api/v1/test-preparations/bc066267-cc01-4544-9e9f-78f65796c280/change/"
    },
    {
      "name": "finish",
      "path": "/api/v1/test-preparations/bc066267-cc01-4544-9e9f-78f65796c280/tests/<test_uuid>/finish"
    },
    {
      "name": "cancel",
      "path": "/api/v1/test-preparations/bc066267-cc01-4544-9e9f-78f65796c280/tests/<test_uuid>/cancel"
    }
  ],
  "test": {
    "descriptor_schema": "https://raw.githubusercontent.com/sonata-nfv/tng-schema/master/test-descriptor/testdescriptor-schema.yml",
    "vendor": "eu.5gtango.atos",
    "name": "test-immersive-media",
    "version": "0.1",
    "author": "Ignacio Dominguez, Felipe Vicens (ATOS)",
    "description": "\"Performance test for video analysis\"\n",
    "service_platforms": "sonata",
    "test_tags": "rtmp-media-service",
    "test_category": "benchmarking",
    "phases": [
      {
        "id": "setup",
        "steps": [
          {
            "name": "deployment",
            "description": "Deploying a NS",
            "action": "deploy"
          },
          {
            "name": "configuration",
            "description": null,
            "action": "configure",
            "probes": [
              {
                "id": "initiator",
                "name": "initiator",
                "image": "sonatanfv/tng-media-pilot-initiator",
                "description": "A service initial configuration container",
                "parameters": [
                  {
                    "key": "CAMERA",
                    "value": "test"
                  },
                  {
                    "key": "CMS",
                    "value": "cms-vnfd.api.serviceendpoint"
                  }
                ]
              },
              {
                "id": "cpe",
                "name": "cpe",
                "image": "sonatanfv/tng-media-pilot-cpe",
                "description": "Content Producer Emulator (CPE) To generate a RTMP flow",
                "parameters": [
                  {
                    "key": "AGGREGATOR",
                    "value": "ma-vnfd.rtmp.serviceendpoint"
                  },
                  {
                    "key": "APP",
                    "value": "test"
                  },
                  {
                    "key": "STREAM",
                    "value": "test"
                  }
                ]
              },
              {
                "id": "cce",
                "name": "cce",
                "image": "sonatanfv/tng-media-pilot-cce",
                "description": "Content Consumer Emulator (CCE) To play HLS flows from Streaming engine",
                "parameters": [
                  {
                    "key": "STREAMMING_ENGINE",
                    "value": "mse-vnfd.hls.serviceendpoint"
                  },
                  {
                    "key": "STREAM",
                    "value": "test"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "id": "exercise",
        "steps": [
          {
            "name": "configure_service",
            "description": "Configuration of the service previuos start tests",
            "run": "initiator",
            "index": 0,
            "start_delay": 0,
            "instances": 1,
            "output": [
              {
                "results": "logs.txt",
                "verdict": "status.txt"
              }
            ]
          },
          {
            "name": "run_camera",
            "description": "Starting the CPE that simulates the camera",
            "run": "cpe",
            "index": 1,
            "start_delay": 5,
            "command": "/path-to-executable/executable.sh",
            "instances": 1,
            "output": [
              {
                "results": "logs.txt",
                "graphs": "detail.json"
              }
            ],
            "dependencies": [
              "initiator"
            ]
          },
          {
            "name": "run_players",
            "description": "Starting the CCE that simulates the consumer",
            "run": "cce",
            "index": 2,
            "start_delay": 15,
            "command": "/path-to-executable/executable.sh",
            "instances": 10,
            "output": [
              {
                "results": "logs.txt",
                "graphs": "detail.json"
              }
            ],
            "dependencies": [
              "cpe"
            ]
          }
        ]
      },
      {
        "id": "verification",
        "steps": [
          {
            "name": "configuration",
            "description": "Check service was configured",
            "step": "configure_service",
            "condition": [
              {
                "parser": {
                  "file": "status.txt",
                  "find": "OK",
                  "value": "present",
                  "verdict": "pass"
                }
              }
            ]
          },
          {
            "name": "user_experience",
            "description": "Check bandwithd received",
            "step": "run_players",
            "condition": [
              {
                "parser": {
                  "file": "detail.json",
                  "type": "json",
                  "find": "error_rate",
                  "value": "< 0.05",
                  "verdict": "pass"
                }
              }
            ]
          }
        ]
      }
    ]
  }
}